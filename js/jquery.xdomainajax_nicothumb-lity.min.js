!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],function(n){return t(e,n)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,require("jquery")):e.lity=t(e,e.jQuery||e.Zepto)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function h(e){var t=i();return v&&e.length?(e.one(v,t.resolve),setTimeout(t.resolve,500)):t.resolve(),t.promise()}function y(e,n,r){if(1===arguments.length)return t.extend({},e);if("string"==typeof n){if("undefined"==typeof r)return"undefined"==typeof e[n]?null:e[n];e[n]=r}else t.extend(e,n);return this}function g(e){for(var r,t=decodeURI(e.split("#")[0]).split("&"),n={},i=0,a=t.length;a>i;i++)t[i]&&(r=t[i].split("="),n[r[0]]=r[1]);return n}function b(e,n){return e+(e.indexOf("?")>-1?"&":"?")+t.param(n)}function x(e,t){var n=e.indexOf("#");return-1===n?t:(n>0&&(e=e.substr(n)),t+e)}function w(e){return t('<span class="lity-error"/>').append(e)}function _(e,n){var r=n.opener()&&n.opener().data("lity-desc")||"Image with no description",a=t('<img src="'+e+'" alt="'+r+'"/>'),o=i(),l=function(){o.reject(w("Failed loading image"))};return a.on("load",function(){return 0===this.naturalWidth?l():void o.resolve(a)}).on("error",l),o.promise()}function j(e,n){var r,i,a;try{r=t(e)}catch(o){return!1}return r.length?(i=t('<i style="display:none !important"/>'),a=r.hasClass("lity-hide"),n.element().one("lity:remove",function(){i.before(r).remove(),a&&!r.closest(".lity-content").length&&r.addClass("lity-hide")}),r.removeClass("lity-hide").after(i)):!1}function C(e){var n=f.exec(e);return n?q(x(e,b("https://www.youtube"+(n[2]||"")+".com/embed/"+n[4],t.extend({autoplay:1},g(n[5]||""))))):!1}function k(e){var n=p.exec(e);return n?q(x(e,b("https://player.vimeo.com/video/"+n[3],t.extend({autoplay:1},g(n[4]||""))))):!1}function T(e){var t=m.exec(e);return t?q(x(e,b("https://www.google."+t[3]+"/maps?"+t[6],{output:t[6].indexOf("layer=c")>0?"svembed":"embed"}))):!1}function q(e){return'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+e+'"/></div>'}function E(){return n.documentElement.clientHeight?n.documentElement.clientHeight:Math.round(r.height())}function D(e){var t=O();t&&(27===e.keyCode&&t.close(),9===e.keyCode&&$(e,t))}function $(e,t){var r=t.element().find(u),i=r.index(n.activeElement);e.shiftKey&&0>=i?(r.get(r.length-1).focus(),e.preventDefault()):e.shiftKey||i!==r.length-1||(r.get(0).focus(),e.preventDefault())}function z(){t.each(o,function(e,t){t.resize()})}function R(e){1===o.unshift(e)&&(a.addClass("lity-active"),r.on({resize:z,keydown:D})),t("body > *").not(e.element()).addClass("lity-hidden").each(function(){var e=t(this);void 0===e.data(s)&&e.data(s,e.attr(l)||null)}).attr(l,"true")}function L(e){var n;e.element().attr(l,"true"),1===o.length&&(a.removeClass("lity-active"),r.off({resize:z,keydown:D})),o=t.grep(o,function(t){return e!==t}),n=o.length?o[0].element():t(".lity-hidden"),n.removeClass("lity-hidden").each(function(){var e=t(this),n=e.data(s);n?e.attr(l,n):e.removeAttr(l),e.removeData(s)})}function O(){return 0===o.length?null:o[0]}function Q(e,n,r,i){var o,a="inline",l=t.extend({},r);return i&&l[i]?(o=l[i](e,n),a=i):(t.each(["inline","iframe"],function(e,t){delete l[t],l[t]=r[t]}),t.each(l,function(t,r){return r?r.test&&!r.test(e,n)?!0:(o=r(e,n),!1!==o?(a=t,!1):void 0):!0})),{handler:a,content:o||""}}function U(e,r,a,o){function v(e){m=t(e).css("max-height",E()+"px"),p.find(".lity-loader").each(function(){var e=t(this);h(e).always(function(){e.remove()})}),p.removeClass("lity-loading").find(".lity-content").empty().append(m),d=!0,m.trigger("lity:ready",[s])}var u,p,m,s=this,d=!1,f=!1;r=t.extend({},c,r),p=t(r.template),s.element=function(){return p},s.opener=function(){return a},s.options=t.proxy(y,s,r),s.handlers=t.proxy(y,s,r.handlers),s.resize=function(){d&&!f&&m.css("max-height",E()+"px").trigger("lity:resize",[s])},s.close=function(){if(d&&!f){f=!0,L(s);var e=i();return o&&t.contains(p,n.activeElement)&&o.focus(),m.trigger("lity:close",[s]),p.removeClass("lity-opened").addClass("lity-closed"),h(m.add(p)).always(function(){m.trigger("lity:remove",[s]),p.remove(),p=void 0,e.resolve()}),e.promise()}},u=Q(e,s,r.handlers,r.handler),p.attr(l,"false").addClass("lity-loading lity-opened lity-"+u.handler).appendTo("body").focus().on("click","[data-lity-close]",function(e){t(e.target).is("[data-lity-close]")&&s.close()}).trigger("lity:open",[s]),R(s),t.when(u.content).always(v)}function W(e,r,i){e.preventDefault?(e.preventDefault(),i=t(this),e=i.data("lity-target")||i.attr("href")||i.attr("src")):i=t(i);var a=new U(e,t.extend({},i.data("lity-options")||i.data("lity"),r),i,n.activeElement);return e.preventDefault?void 0:a}var n=e.document,r=t(e),i=t.Deferred,a=t("html"),o=[],l="aria-hidden",s="lity-"+l,u='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',c={handler:null,handlers:{image:_,inline:j,youtube:C,vimeo:k,googlemaps:T,iframe:q},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'},d=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,f=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i,p=/(vimeo(pro)?.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/,m=/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i,v=function(){var e=n.createElement("div"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var r in t)if(void 0!==e.style[r])return t[r];return!1}();return _.test=function(e){return d.test(e)},W.version="2.1.0",W.options=t.proxy(y,W,c),W.handlers=t.proxy(y,W,c.handlers),W.current=O,t(n).on("click.lity","[data-lity]",W),W}),jQuery.ajax=function(e){function o(e){return!r.test(e)&&/:\/\//.test(e)}var t=location.protocol,n=location.hostname,r=RegExp(t+"//"+n),i="http"+(/^https/.test(t)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?",a='select * from html where url="{URL}" and xpath="*"';return function(t){var n=t.url;return/get/i.test(t.type)&&!/json/i.test(t.dataType)&&o(n)&&(a="xml"==t.dataType?'select * from xml where url="{URL}"':a,t.url=i,t.dataType="json",t.data={q:a.replace("{URL}",n+(t.data?(/\?/.test(n)?"&":"?")+jQuery.param(t.data):"")),format:"xml"},!t.success&&t.complete&&(t.success=t.complete,delete t.complete),t.success=function(e){return function(t){e&&e.call(this,{responseText:(t.results[0]||"").replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"")},"success")}}(t.success)),e.apply(this,arguments)}}(jQuery.ajax),$.fn.nicothumb=function(e){var t=$.extend({video_id:"sm9",insert:!0,template:'<h1><a href="{watch_url}">{title}</a></h1><a href="{watch_url}"><img src="{thumbnail_url}" alt="サムネイル"></a><p>再生数: <span>{view_counter}</span></p><p>コメント数: <span>{comment_num}</span></p><p>マイリスト数: <span>{mylist_counter}</span></p><p>再生時間: <span>{length}</span></p>',callback:function(){}},e),n="http://ext.nicovideo.jp/thumb/",r=$(this),i={status:"ok",title:"",view_counter:0,comment_num:0,mylist_counter:0,length:"",watch_url:"",thumbnail_url:""};return $.ajax({url:n+t.video_id,type:"GET"}).done(function(e){var n=$(e.results[0]),a="";n.find("a.video").text()?(i.title=n.find("a.video").text(),i.view_counter=n.find("strong:nth-of-type(1)").eq(0).text(),i.comment_num=n.find("strong:nth-of-type(2)").eq(0).text(),i.mylist_counter=n.find("strong:nth-of-type(3)").eq(0).text(),i.length=n.find("strong:nth-of-type(1)").eq(1).text(),i.watch_url=n.find("a.video").attr("href"),i.thumbnail_url=n.find("img.video_img").attr("src"),a=t.template,a=a.replace(/{title}/g,i.title),a=a.replace(/{view_counter}/g,i.view_counter),a=a.replace(/{comment_num}/g,i.comment_num),a=a.replace(/{mylist_counter}/g,i.mylist_counter),a=a.replace(/{length}/g,i.length),a=a.replace(/{watch_url}/g,i.watch_url),a=a.replace(/{thumbnail_url}/g,i.thumbnail_url)):(i.status="error",a="<h1>取得に失敗しました</h1>"),console.log(a),t.insert&&r.html(a),t.callback(i)}),this};